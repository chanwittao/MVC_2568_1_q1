<!-- File: src/views/layouts/main.ejs -->
<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>р╕гр╕░р╕Ър╕Ър╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╣Ар╕гр╕╡р╕вр╕Щр╕ер╣Ир╕зр╕Зр╕лр╕Щр╣Йр╕▓</title>
  <style>
    body { font-family: Tahoma, sans-serif; margin: 20px; }
    nav a { margin-right: 12px; }
    .flash { padding: 8px; background: #fce4ec; margin-bottom: 10px; border: 1px solid #f48fb1; }
  </style>
</head>
<body>

  <%
    // р╕Фр╕╢р╕З user р╕Ир╕▓р╕Б res.locals (р╕Цр╕╣р╕Б set р╣Гр╕Щ app.js)
    const currentUser = (typeof user !== 'undefined') ? user : null;
    const role = currentUser ? currentUser.role : null;
    const flashMsg = (typeof flash !== 'undefined') ? flash : null;
  %>

<nav>
  <% if (role === 'student') { %>
    <a href="/student/profile">ЁЯУД р╣Вр╕Ыр╕гр╣Др╕Яр╕ер╣М</a>
    <a href="/student/enroll?term=1">ЁЯУЪ р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╣Ар╕Чр╕нр╕б 1</a>
    <a href="/student/enroll?term=2">ЁЯУЪ р╕ер╕Зр╕Чр╕░р╣Ар╕Ър╕╡р╕вр╕Щр╣Ар╕Чр╕нр╕б 2</a>
    <a href="/logout">ЁЯЪк р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ъ</a>
  <% } else if (role === 'admin') { %>
    <a href="/admin/students">ЁЯСе р╕лр╕Щр╣Йр╕▓р╕гр╕зр╕бр╕Щр╕▒р╕Бр╕ир╕╢р╕Бр╕йр╕▓</a>
    <a href="/admin/tools/reset" style="color:#b00;font-weight:bold;">тЪая╕П р╕гр╕╡р╣Ар╕Лр╣Зр╕Хр╕Рр╕▓р╕Щр╕Вр╣Йр╕нр╕бр╕╣р╕е</a>
    <a href="/logout">ЁЯЪк р╕нр╕нр╕Бр╕Ир╕▓р╕Бр╕гр╕░р╕Ър╕Ъ</a>
  <% } else { %>
    <a href="/">ЁЯФС р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╕Щр╕▒р╕Бр╕ир╕╢р╕Бр╕йр╕▓</a>
    <a href="/register">ЁЯУЭ р╕кр╕бр╕▒р╕Др╕гр╕Щр╕▒р╕Бр╕ир╕╢р╕Бр╕йр╕▓р╣Гр╕лр╕бр╣И</a>
    <a href="/admin/login">ЁЯЫая╕П р╣Ар╕Вр╣Йр╕▓р╕кр╕╣р╣Ир╕гр╕░р╕Ър╕Ър╣Бр╕нр╕Фр╕бр╕┤р╕Щ</a>
  <% } %>
</nav>

  <% if (flashMsg) { %>
    <div class="flash"><%= flashMsg %></div>
  <% } %>

  <%- body %>
</body>
</html>